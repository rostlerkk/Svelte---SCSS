$("#intro > p").text("loading configuration"),pano.on("configloaded",(function(){$("#intro > p").text("loading panoramas")}));var readMoreTxt="",readLessTxt="";function AddReadMore(t,a){switch(pano.getVariableValue("lang")){case"sk":t="... zobraziť viac",a="... zobraziť menej";break;case"en":t="... read more",a="... read less";break}$(".attribute-description > div").each((function(){if(!$(this).find(".firstSec").length){var e=$(this).text();if(e.length>200){var i=e.substring(0,200)+"<span class='SecSec'>"+e.substring(200,e.length)+"</span><span class='readMore'  title='Click to Show More'>"+t+"</span><span class='readLess' title='Click to Show Less'>"+a+"</span>";$(this).html(i)}}})),$(".readMore").on("click touchstart",(function(){$(this).parent().toggleClass("showmorecontent"),$(this).parent().toggleClass("showlesscontent")})),$(".readLess").on("click touchstart",(function(){$(this).parent().toggleClass("showmorecontent"),$(this).parent().toggleClass("showlesscontent")}))}function hideMedia(t){pano.setMediaVisibility(t,"0",0)}function showMedia(t){pano.setMediaVisibility(t,"1",0)}function najdiAktualnyByt(){UserData=pano.getNodeUserdata(pano.getCurrentNode()),bytID=UserData.copyright,null==bytID||bytID}$((function(){AddReadMore()}));var pocetPatchov,IdsFile="assets/data/ids.csv",importFile="assets/data/import.csv",hotspotsFile="assets/data/hotspots.csv",Ids={},Flats={},patches={},Hotspots={};function readIds(t,a){for(var e=t.split("\n"),i=1;i<e.length;i++)_attrID=e[i].split(";")[0],_attrGroupName_SK=e[i].split(";")[1],_attrGroupName_EN=e[i].split(";")[2],_attrNames_SK=e[i].split(";")[3],_attrNames_EN=e[i].split(";")[4],_attrDescriptions_SK=e[i].split(";")[5],_attrDescriptions_EN=e[i].split(";")[6],_attrPrices=e[i].split(";")[7],_attrThumbnails=e[i].split(";")[8],_attrPremium=e[i].split(";")[9],_attrTarget=e[i].split(";")[10],void 0!==_attrGroupName_SK&&(_attrGroupName_SK=_attrGroupName_SK.toString().replace("\r","").split("|")),void 0!==_attrGroupName_EN&&(_attrGroupName_EN=_attrGroupName_EN.toString().replace("\r","").split("|")),void 0!==_attrNames_SK&&(_attrNames_SK=_attrNames_SK.toString().replace("\r","").split("|")),void 0!==_attrNames_EN&&(_attrNames_EN=_attrNames_EN.toString().replace("\r","").split("|")),void 0!==_attrDescriptions_SK&&(_attrDescriptions_SK=_attrDescriptions_SK.toString().replace("\r","").split("|")),void 0!==_attrDescriptions_EN&&(_attrDescriptions_EN=_attrDescriptions_EN.toString().replace("\r","").split("|")),void 0!==_attrPrices&&(_attrPrices=_attrPrices.toString().replace("\r","").split("|")),void 0!==_attrThumbnails&&(_attrThumbnails=_attrThumbnails.toString().replace("\r","").split("|")),void 0!==_attrPremium&&(_attrPremium=_attrPremium.toString().replace("\r","").split("|")),void 0!==_attrTarget&&(_attrTarget=_attrTarget.toString().replace("\r","").split("|")),null==_attrID||""==_attrID||(a[_attrID]={id:_attrID,_attrGroupName:{sk:_attrGroupName_SK,en:_attrGroupName_EN},_attrNames:{sk:_attrNames_SK,en:_attrNames_EN},_attrDescriptions:{sk:_attrDescriptions_SK,en:_attrDescriptions_EN},_attrPrices:_attrPrices,_attrThumbnails:_attrThumbnails,_attrPremium:_attrPremium,_attrTarget:_attrTarget})}function readFlats(t,a){for(var e=t.split("\n"),i="",s="",r=1;r<e.length;r++){function n(){a[i][s]={id:s},a[i][s].groupName={sk:Ids[s]._attrGroupName.sk,en:Ids[s]._attrGroupName.en},a[i][s].title={sk:Ids[s]._attrGroupName.sk,en:Ids[s]._attrGroupName.en},a[i][s].target=s,a[i][s].names={sk:Ids[s]._attrNames.sk,en:Ids[s]._attrNames.en},a[i][s].targetUrl=Ids[s]._attrTarget,a[i][s].descriptions={sk:Ids[s]._attrDescriptions.sk,en:Ids[s]._attrDescriptions.en},""==_flatAttrPrices||"\r"==_flatAttrPrices?a[i][s].prices=Ids[s]._attrPrices:a[i][s].prices=_flatAttrPrices.toString().replace("\r","").split("|"),a[i][s].thumbnails=Ids[s]._attrThumbnails,""==_flatAttrGrouped?a[i][s].grouped="":a[i][s].grouped=_flatAttrGrouped.toString().replace("\r",""),""==_flatAttrExtended||"\r"==_flatAttrExtended||(a[i][s].extended=_flatAttrExtended.toString().replace("\r","")),""==_flatAttrGlobalChange||"\r"==_flatAttrGlobalChange?a[i][s].globalChange="":a[i][s].globalChange=_flatAttrGlobalChange.toString().replace("\r",""),""==_flatAttrActiveItem||"\r"==_flatAttrActiveItem?a[i][s].activeItem=0:a[i][s].activeItem=_flatAttrActiveItem.toString().replace("\r",""),a[i][s].premium=Ids[s]._attrPremium,""==_flatAttrActiveItem||"\r"==_flatAttrActiveItem?a[i][s].default=0:a[i][s].default=_flatAttrActiveItem.toString().replace("\r","")}i=e[r].split(";")[0],s=e[r].split(";")[1],_flatAttrName=e[r].split(";")[2],_flatAttrPrices=e[r].split(";")[3],_flatAttrGrouped=e[r].split(";")[4],_flatAttrExtended=e[r].split(";")[5],_flatAttrGlobalChange=e[r].split(";")[6],_flatAttrActiveItem=e[r].split(";")[7],""==s||null==s||null==s||""==_flatAttrActiveItem||_flatAttrActiveItem,""==i||(i in a||(a[i]={}),n())}}function readHotspots(t,a){for(var e=t.split("\n"),i=1;i<e.length;i++){function s(){a[_panoID][_hotspotID]={id:_hotspotID.toString().replace("\r","")},a[_panoID][_hotspotID]={skinTemplate:_hotspotSkinTemplate.toString().replace("\r",""),PAN:_pan.toString().replace("\r",""),TILT:_tilt.toString().replace("\r",""),_hotspotTitle:{sk:_hotspotTitle_SK.toString().replace("\r",""),en:_hotspotTitle_EN.toString().replace("\r","")},_hotspotDescription:{sk:_hotspotDescriptions_SK.toString().replace("\r",""),en:_hotspotDescriptions_EN.toString().replace("\r","")},url:_hotspotURL,target:_hotspotTarget.toString().replace("\r","")}}_panoID=e[i].split(";")[0],_hotspotID=e[i].split(";")[1],_hotspotSkinTemplate=e[i].split(";")[2],_pan=e[i].split(";")[3],_tilt=e[i].split(";")[4],_hotspotTitle_SK=e[i].split(";")[5],_hotspotTitle_EN=e[i].split(";")[6],_hotspotDescriptions_SK=e[i].split(";")[7],_hotspotDescriptions_EN=e[i].split(";")[8],_hotspotURL=e[i].split(";")[9],_hotspotTarget=e[i].split(";")[1],""==_panoID||(_panoID in a||(a[_panoID]={}),s())}}function nacitajId(){$.ajax({type:"GET",url:IdsFile,dataType:"text",success:function(t){readIds(t,Ids),nacitajByty()},error:function(){},complete:function(){}})}function nacitajByty(){$.ajax({type:"GET",url:importFile,dataType:"text",success:function(t){readFlats(t,Flats),nacitajPatche()},error:function(){},complete:function(){}})}function nacitajPatche(){$.ajax({url:"pano.xml",dataType:"xml",success:function(t){var a=$("tour",t),e={};$.each(a.find("panorama"),(function(){nodeID=$(this)[0].id;var t=$(this).find("panorama>media>image");e[nodeID]=t,patches[nodeID]=[],$.each(e[nodeID],(function(t){patches[nodeID].push(e[nodeID][t].id)}))})),UpdateCurrentPatches(),nacitajHotspoty(),$.getScript("extended.js"),pano.on("changenode",(function(){attributesReady(),UpdateCurrentPatches()}))},error:function(t){},complete:function(t){}})}function nacitajHotspoty(){$.ajax({type:"GET",url:hotspotsFile,dataType:"text",success:function(t){readHotspots(t,Hotspots),1==attributesAllow&&attributesReady()},error:function(){},complete:function(){pano.on("varchanged_lang",(function(){1==attributesAllow&&(updateTexts(),generateCart(Flats))}))}})}function UpdateCurrentPatches(){if(najdiAktualnyByt(),activeNode=pano.getCurrentNode(),null==patches[activeNode]||0==patches[activeNode].length||null==Flats[bytID]);else{if((pocetPatchov=patches[activeNode].length)>0)for(i=0;i<pocetPatchov;i++)hideMedia(patches[activeNode][i]);if(patchesNames=[],pocetPatchov>0||null!=Flats[bytID]){for(i=0;i<pocetPatchov;i++)-1!==jQuery.inArray(patches[activeNode][i].split("_")[0],patchesNames)||patchesNames.push(patches[activeNode][i].split("_")[0]);for(i=0;i<patchesNames.length;i++)aTitle=patchesNames[i],aItem=Flats[bytID][patchesNames[i]].activeItem,patchName=aTitle+"_"+aItem,showMedia(patchName)}}}function attributesReady(){var t=$(".hts"),a=t.length;if(a>0){counter=a,activeItem=pano.getCurrentNode();var e=Object.keys(Hotspots[activeItem]);for(i=0;i<a;i++)counter--,t.eq(i).attr("data-target",e[counter]);$(".hts-attributes").on("click touchstart",(function(){targetAttr=$(this).attr("data-target"),pano.setVariableValue("attributes_side",!pano.getVariableValue("attributes_side")),UpdateCurrentPatches()})),generateCart(Flats)}}function generateCart(t){$(".attributes-group").empty();var a=$(".app-cart > .attributes-group");function e(t,e){e=$(t).height(),a.css("max-height",e-374)}$(window).resize((function(){e("window",0)})),pano.addListener("varchanged_app_cart",(function(){switch(pano.getVariableValue("app_cart")){case!0:e("window",0),variableFalse(["settings","shortcuts"]),ShowElement([".app-cart"]),addClass([".adv-wrapper"],"hidden"),addClass([".hlp-layer"],"active"),variableFalse(["lang_menu"]);break;case!1:HideElement([".app-cart"]),removeClass([".adv-wrapper"],"hidden"),removeClass([".hlp-layer"],"active");break}}));var i=$(".hlp-layer");i.on("click tap",(function(){variableFalse(["app_cart"])})),pano.addListener("varchanged_blurred",(function(){switch(pano.getVariableValue("blurred")){case!0:i.removeClass("active"),variableFalse(["app_cart"]);break}})),addItemToCart(t),UpdateTotalPrice()}var CartDescLimit=35;function addItemToCart(t){var a=$(".attributes-group");a.empty(),lang=pano.getVariableValue("lang"),bytID=UserData.copyright,$.each(t[bytID],(function(e,i){function s(t){return txt=t.descriptions[lang][activeItem],txt.length>CartDescLimit?(txt=txt.substring(0,CartDescLimit)+" ...",txt):t.descriptions[lang][activeItem]}if(activeItem=i.activeItem,1==selectByPremium)if("premium"==t[bytID][e].premium[activeItem]){var r='<div class="attributes-item opened"><div><div class="att-title premium" id='+e+">"+i.groupName[lang][0]+'<span class="closed"></span></div><div class="values-group"><div class="value"><div class="left"><div class="thumb '+i.thumbnails[activeItem]+'"></div><div class="parameters"><div class="param-title">'+i.names[lang][activeItem]+'</div><div class="param-description">'+s(i)+'</div></div></div><div class="right"><div class="param-price">'+i.prices[activeItem]+"</div></div></div></div></div>";a.append(r)}else{r='<div class="attributes-item opened"><div><div class="att-title" id='+e+">"+i.groupName[lang][0]+'<span class="closed"></span></div><div class="values-group"><div class="value"><div class="left"><div class="thumb '+i.thumbnails[activeItem]+'"></div><div class="parameters"><div class="param-title">'+i.names[lang][activeItem]+'</div><div class="param-description">'+s(i)+'</div></div></div><div class="right"><div class="param-price">'+i.prices[activeItem]+"</div></div></div></div></div>";a.append(r)}else if(activeItem==t[bytID][e].default){r='<div class="attributes-item opened"><div><div class="att-title" id='+e+">"+i.groupName[lang][0]+'<span class="closed"></span></div><div class="values-group"><div class="value"><div class="left"><div class="thumb '+i.thumbnails[activeItem]+'"></div><div class="parameters"><div class="param-title">'+i.names[lang][activeItem]+'</div><div class="param-description">'+s(i)+'</div></div></div><div class="right"><div class="param-price">'+i.prices[activeItem]+"</div></div></div></div></div>";a.append(r)}else{r='<div class="attributes-item opened"><div><div class="att-title premium" id='+e+">"+i.groupName[lang][0]+'<span class="closed"></span></div><div class="values-group"><div class="value"><div class="left"><div class="thumb '+i.thumbnails[activeItem]+'"></div><div class="parameters"><div class="param-title">'+i.names[lang][activeItem]+'</div><div class="param-description">'+s(i)+'</div></div></div><div class="right"><div class="param-price">'+i.prices[activeItem]+"</div></div></div></div></div>";a.append(r)}})),$(".att-title").on("click tap",(function(t){$(this).next(".values-group").slideToggle(250),$(this).find("span").toggleClass("opened")}))}function updateItemInCart(t,a){function e(t){return txt=a[bytID][t].descriptions[lang][activeItem],txt.length>CartDescLimit?(txt=txt.substring(0,CartDescLimit)+" ...",txt):txt}lang=pano.getVariableValue("lang"),activeItem=a[bytID][targetAttr].activeItem,$("#"+t).next(".values-group").find(".param-title").empty().append(a[bytID][targetAttr].names[lang][activeItem]),$("#"+t).next(".values-group").find(".thumb").removeAttr("class").addClass("thumb").addClass(a[bytID][targetAttr].thumbnails[activeItem]),$("#"+t).next(".values-group").find(".param-description").empty().append(e(targetAttr)),$("#"+t).next(".values-group").find(".param-price").empty().append(a[bytID][targetAttr].prices[activeItem]),1==selectByPremium?"premium"==a[bytID][targetAttr].premium[activeItem]?$("#"+t).addClass("premium"):$("#"+t).removeClass("premium"):activeItem==a[bytID][targetAttr].default?$("#"+t).removeClass("premium"):$("#"+t).addClass("premium");var i=a[bytID][targetAttr].globalChange;""!==i&&$.each(a[bytID],(function(t,s){a[bytID][t].globalChange==i&&a[bytID][targetAttr]!==a[bytID][t]&&($("#"+t).next(".values-group").find(".param-title").empty().append(a[bytID][t].names[lang][activeItem]),$("#"+t).next(".values-group").find(".thumb").removeAttr("class").addClass("thumb").addClass(a[bytID][t].thumbnails[activeItem]),$("#"+t).next(".values-group").find(".param-description").empty().append(e(t)),$("#"+t).next(".values-group").find(".param-price").empty().append(a[bytID][t].prices[activeItem]))}))}function UpdateTotalPrice(){var t=null;$(".param-price").each((function(){t+=parseInt(this.innerHTML)})),t=parseInt(t).toLocaleString(),$(".total-price").empty().append(t)}